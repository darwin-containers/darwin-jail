name: CI
on: [push, pull_request]
jobs:
  lint:
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v3
      - uses: psf/black@stable
  test:
    strategy:
      fail-fast: false
      matrix:
        os: [
          macos-10.15,
          # TODO: for some reason, fails on GitHub Actions, even though passes locally
          # macos-11,
          # macos-12,
        ]
    runs-on: ${{ matrix.os }}
    steps:
    - name: Checkout
      uses: actions/checkout@v3
    - name: Setup Python
      uses: actions/setup-python@v3
    - name: Create jail
      run: sudo python -m macosjail jail
    - name: Test jail
      run: sudo chroot jail ls -l
